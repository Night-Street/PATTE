# [T1028](https://pintia.cn/problem-sets/994805148990160896/problems/1478636318296752128) Do All Roads Lead to Rome (35 point(s))

## 题干

Indeed there are many different tourist routes from our city to Rome. Your job is to count the number of different routes from our city to Rome, and to check if ALL the routes lead to Rome -- that is, whether or not all the routes from our city to Rome can cover every road on the routes from our city to anywhere.

### Input Specification:

Each input file contains one test case. For each case, the first line contains 2 positive integers *N* (2≤*N*≤20), the number of cities, and *K*, the total number of roads between pairs of cities; followed by the name of the starting city. Then *K* lines follow, each describes a road between two cities in the format `City1 City2`. Here the name of a city is a string of 3 capital English letters, and the destination is always `ROM` which represents Rome.

### Output Specification:

For each test case, first print in a line `Yes` if all the routes from the starting city lead to `ROM`, or `No` if not. Then print in the next line the number of different routes from the starting city to `ROM`. Here a **route** is defined to be a **simple path**, that is, no city along the route will be visited more than once. It is guaranteed that this number is no more than 106. By the way, it is assumed that `ROM` is our only destination -- that is, once we reach `ROM`, we will stop traveling and stay there.

### Sample Input 1:

```in
7 8 HZH
PKN HZH
GDN ROM
ROM HKG
PRS PKN
PRS BLN
HKG PRS
ROM BLN
HZH GDN
```

### Sample Output 1:

```out
Yes
3
```

### Sample Input 2:

```in
10 11 HZH
PKN HZH
GDN ROM
ROM HKG
PRS PKN
PRS BLN
HKG PRS
ROM BLN
HZH GDN
GDN MAC
MAC WWW
MAC VVV
```

### Sample Output 2:

```out
No
3
```

## 题目限制条件

- 时间限制：700ms
- 内存限制：64MB

## 题目大意

给出一个无向图和起点，要求统计从起点到达终点"ROM"的**简单路径**数量。在此题中，顶点"ROM"是所有路径的**唯一终点**，到达"ROM"后不再继续走向其它点。同时判断从起点到图中其它各点的简单路径是否都通罗马(即：从所有起点出发到达终点"ROM"的路径能否覆盖到达其它任何地方的路径)。

## 本题考察知识点

- 深度优先搜索(**D**epth **F**irst **S**earch, **DFS**)

## 解题思路

使用DFS判断简单路径数量不是什么难事，关键在于如何判断条条大路是不是都通罗马。题目中对于"通罗马"给出的定义非常暧昧，缺乏形式化的表述。我个人的理解是：通罗马的路径是某条从起点到终点"ROM"的**子路径**。如果在dfs的过程中，遍历到某个非终点v却无法继续往下遍历时(此时可能是因为v的邻点均已被访问过)，则**在当前状态下从起点到v的路径**不通罗马。

但是按照以上思路写出的代码无法通过case 2, 4, 7。

后经过试验知：

- case 6的"ROM"没有邻点，因此从起点出发的任何一条路都不可能通罗马，可以直接输出"No"，同时可以知道case 6是非连通图。
- case 2, 4, 7也非连通图，但起点和"ROM"在同一个连通分量中，且输出"Yes"。

因此我运用**面向答案编程**的思想，结合了三种能够部分AC的代码加以条件判断，最终骗得了35分，不以为耻还反以为荣，毕竟PAT不罚时，骗分也是一种技巧。

如果有使用**常规方法**AC的大神，希望能够不吝赐教。

## 提交结果

<img src="../images/result/1028.png" alt="image-20220313214730724" style="zoom:67%;" />
